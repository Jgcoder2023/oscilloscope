#include "show.h"


/*
*   ∫Ø ˝ƒ⁄»›£∫PWMµƒæ≤÷πUIΩÁ√Ê
*   ∫Ø ˝≤Œ ˝£∫Œﬁ
*   ∑µªÿ÷µ£∫  Œﬁ
*/
void PWM_StaticUI(void){
	static enum MenuState MyMenu;
    uint16_t i=0,j=0;
    char showData[12]={0};

    if(oscilloscope.KnobValue > 0){
        //”“∑≠“≥ 
        oscilloscope.ThisMenu = DAC;
        oscilloscope.KnobValue = 0;
    } 
    if(oscilloscope.KnobValue < 0){
    	// ◊Û∑≠“≥
        oscilloscope.ThisMenu = SetInput;
        oscilloscope.KnobValue = 0;
    }
    if(F_KeyState(0)){   //µ•ª˜Ω¯»•…Ë÷√
        oscilloscope.ThisMenu = SetPwmOut;
    }
	// ∑¿÷π÷ÿ∏¥À¢–¬
	if(MyMenu == oscilloscope.ThisMenu){
		return;
	}
	MyMenu = oscilloscope.ThisMenu;

    TFT_ShowChinese(10,0,(uint8_t *)"ºÚ“◊ æ≤®∆˜",BLACK,GREEN,16,0);
    
    sprintf(showData,"  PWM ");
    TFT_ShowString(110,0,(uint8_t *)showData,RED,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(110,20,(uint8_t *)" ‰≥ˆ◊¥Ã¨",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,36,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(110,56,(uint8_t *)" ‰≥ˆ∆µ¬ ",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,72,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    sprintf(showData,"        ");
    TFT_ShowString(110,92,(uint8_t *)showData,WHITE,PURPLE,12,0);  
    memset(showData,0,12);
    TFT_ShowChinese(118,92,(uint8_t *)"’ºø’±»",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,106,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(5,92,(uint8_t *)" ‰»Î∑˘÷µ",WHITE,PURPLE,12,0);
    
    TFT_ShowChinese(55,92,(uint8_t *)" ‰»Î∆µ¬ ",WHITE,PURPLE,12,0);
    
    for(i=0;i<=128;i=i+2){
        TFT_DrawPoint(106,i,YELLOW);
    }
    
    for(i=0;i<100;i++){
        TFT_DrawPoint(i,81,GREEN);
    }
    for(i=30;i<=80;i++){
        TFT_DrawPoint(0,i,GREEN);
    }
    for(i=0;i<10;i++){
        TFT_DrawPoint((i*10)+2,82,GREEN); 
        TFT_DrawPoint((i*10)+3,82,GREEN); 
    }
    for(i=0;i<10;i++){
        TFT_DrawPoint((i*10)+2,83,GREEN); 
        TFT_DrawPoint((i*10)+3,83,GREEN);
    }
}

/*
*   ∫Ø ˝ƒ⁄»›£∫DACµƒæ≤÷πUIΩÁ√Ê
*   ∫Ø ˝≤Œ ˝£∫Œﬁ
*   ∑µªÿ÷µ£∫  Œﬁ
*/
void DAC_StaticUI(void){
	static enum MenuState MyMenu;
    uint16_t i=0,j=0;
    char showData[12]={0};

	if(oscilloscope.KnobValue > 0){
        //”“∑≠“≥ 
    	oscilloscope.ThisMenu = SetInput;
        oscilloscope.KnobValue = 0;
    } 
    if(oscilloscope.KnobValue < 0){
        // ◊Û∑≠“≥
        oscilloscope.ThisMenu = PWM;
        oscilloscope.KnobValue = 0;
    }
    if(F_KeyState(0)){   //µ•ª˜Ω¯»•…Ë÷√
        oscilloscope.ThisMenu = SetDacOut;
    }

	// ∑¿÷π÷ÿ∏¥À¢–¬
	if(MyMenu == oscilloscope.ThisMenu){
		return;
	}
	MyMenu = oscilloscope.ThisMenu;
    
    // TFT_ShowChinese(10,0,(uint8_t *)"ºÚ“◊ æ≤®∆˜",BLACK,GREEN,16,0);
    
    sprintf(showData,"  DAC ");
    TFT_ShowString(110,0,(uint8_t *)showData,RED,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(110,20,(uint8_t *)" ‰≥ˆ◊¥Ã¨",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,36,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(110,56,(uint8_t *)" ‰≥ˆµÁ—π",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,72,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    sprintf(showData,"        ");
    TFT_ShowString(110,92,(uint8_t *)showData,WHITE,PURPLE,12,0);  
    memset(showData,0,12);

    // TFT_ShowChinese(118,92,(uint8_t *)"’ºø’±»",BLACK,BLACK,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,106,(uint8_t *)showData,BLACK,BLACK,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(5,92,(uint8_t *)" ‰»Î∑˘÷µ",WHITE,PURPLE,12,0);
    
    TFT_ShowChinese(55,92,(uint8_t *)" ‰»Î∆µ¬ ",WHITE,PURPLE,12,0);
    
    for(i=0;i<=128;i=i+2){
        TFT_DrawPoint(106,i,YELLOW);
    }
    
    for(i=0;i<100;i++){
        TFT_DrawPoint(i,81,GREEN);
    }
    for(i=30;i<=80;i++){
        TFT_DrawPoint(0,i,GREEN);
    }
    for(i=0;i<10;i++){
        TFT_DrawPoint((i*10)+2,82,GREEN); 
        TFT_DrawPoint((i*10)+3,82,GREEN); 
    }
    for(i=0;i<10;i++){
        TFT_DrawPoint((i*10)+2,83,GREEN); 
        TFT_DrawPoint((i*10)+3,83,GREEN);
    }
}




/*
*   ∫Ø ˝ƒ⁄»›£∫SETµƒæ≤÷πUIΩÁ√Ê
*   ∫Ø ˝≤Œ ˝£∫Œﬁ
*   ∑µªÿ÷µ£∫  Œﬁ
*/
void SET_StaticUI(void){
	static enum MenuState MyMenu;
    uint16_t i=0,j=0;
    char showData[12]={0};

	
	if(oscilloscope.KnobValue > 0){
        //”“∑≠“≥ 
        oscilloscope.ThisMenu = PWM;
        oscilloscope.KnobValue = 0;
    } 
    if(oscilloscope.KnobValue < 0){
        // ◊Û∑≠“≥
        oscilloscope.ThisMenu = DAC;
        oscilloscope.KnobValue = 0;
    }

	// ∑¿÷π÷ÿ∏¥À¢–¬
	if(MyMenu == oscilloscope.ThisMenu){
		return;
	}
	MyMenu = oscilloscope.ThisMenu;
    
    // TFT_ShowChinese(10,0,(uint8_t *)"ºÚ“◊ æ≤®∆˜",BLACK,GREEN,16,0);
    
    sprintf(showData,"  SET ");
    TFT_ShowString(110,0,(uint8_t *)showData,RED,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(110,20,(uint8_t *)"ÒÓ∫œ◊¥Ã¨",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,36,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(110,56,(uint8_t *)"À•ºı◊¥Ã¨",WHITE,PURPLE,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,72,(uint8_t *)showData,BLACK,YELLOW,16,0);  
    memset(showData,0,12);
    
    sprintf(showData,"        ");
    TFT_ShowString(110,92,(uint8_t *)showData,WHITE,PURPLE,12,0);  
    memset(showData,0,12);

    // TFT_ShowChinese(118,92,(uint8_t *)"’ºø’±»",BLACK,BLACK,12,0);
    
    sprintf(showData,"      ");
    TFT_ShowString(110,106,(uint8_t *)showData,BLACK,BLACK,16,0);  
    memset(showData,0,12);
    
    TFT_ShowChinese(5,92,(uint8_t *)" ‰»Î∑˘÷µ",WHITE,PURPLE,12,0);
    
    TFT_ShowChinese(55,92,(uint8_t *)" ‰»Î∆µ¬ ",WHITE,PURPLE,12,0);
    
    for(i=0;i<=128;i=i+2){
        TFT_DrawPoint(106,i,YELLOW);
    }
    
    for(i=0;i<100;i++){
        TFT_DrawPoint(i,81,GREEN);
    }
    for(i=30;i<=80;i++){
        TFT_DrawPoint(0,i,GREEN);
    }
    for(i=0;i<10;i++){
        TFT_DrawPoint((i*10)+2,82,GREEN); 
        TFT_DrawPoint((i*10)+3,82,GREEN); 
    }
    for(i=0;i<10;i++){
        TFT_DrawPoint((i*10)+2,83,GREEN); 
        TFT_DrawPoint((i*10)+3,83,GREEN);
    }
}


// …Ë÷√pwm ‰≥ˆ∞¥º¸…®√Ë
void SetPwmOutFc(void){
	if(oscilloscope.KnobValue > 0){//”“∑≠“≥ 
        oscilloscope.ThisMenu = SetPwmFreq;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){// ◊Û∑≠“≥
        oscilloscope.ThisMenu = PWM;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetPwmOutAck;
		return;
	}
}
// …Ë÷√pwm∆µ¬ ∞¥º¸…®√Ë
void SetPwmFreqFc(void){
	if(oscilloscope.KnobValue > 0){ //”“∑≠“≥ 
        oscilloscope.ThisMenu = SetPwmDutyCycle;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){  // ◊Û∑≠“≥
        oscilloscope.ThisMenu = SetPwmOut;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetPwmFreqAck;
		return;
	}
}
//…Ë÷√pwm’ºø’±»∞¥º¸…®√Ë
void SetPwmDutyCycleFc(void){
	if(oscilloscope.KnobValue > 0){ //”“∑≠“≥ 
        oscilloscope.ThisMenu = PWM;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){  // ◊Û∑≠“≥
        oscilloscope.ThisMenu = SetPwmFreq;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetPwmDutyCycleAck;
		return;
	}
}
// …Ë÷√DAC ‰≥ˆ£®∞¥º¸…®√Ë£©
void SetDacOutFc(void){
	if(oscilloscope.KnobValue > 0){ //”“∑≠“≥ 
        oscilloscope.ThisMenu = SetDacDutyCycle;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){  // ◊Û∑≠“≥
        oscilloscope.ThisMenu = DAC;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDacOutAck;
		return;
	}
}
// …Ë÷√DACµƒ’ºø’±»
void SetDacDutyCycleFc(void){
	if(oscilloscope.KnobValue > 0){ //”“∑≠“≥ 
        oscilloscope.ThisMenu = DAC;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){  // ◊Û∑≠“≥
        oscilloscope.ThisMenu = SetDacOut;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDacDutyCycleAck;
		return;
	}
}
// …Ë÷√Ωª÷±¡˜ÒÓ∫œ
void SetDcAcFc(void){
    if(oscilloscope.KnobValue > 0){ //”“∑≠“≥ 
        oscilloscope.ThisMenu = SetDecay;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){  // ◊Û∑≠“≥
        oscilloscope.ThisMenu = SetInput;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDcAcAck;
		return;
	}
}
// …Ë÷√À•ºı
void SetDecayFc(void){
    if(oscilloscope.KnobValue > 0){ //”“∑≠“≥ 
        oscilloscope.ThisMenu = SetInput;
        oscilloscope.KnobValue = 0;
		return;
    } 
    if(oscilloscope.KnobValue < 0){  // ◊Û∑≠“≥
        oscilloscope.ThisMenu = SetDcAc;
        oscilloscope.KnobValue = 0;
		return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDecayAck;
		return;
	}
}


// …Ë÷√pwm ‰≥ˆ∞¥º¸…®√Ë£®…¡À∏◊¥Ã¨£©
void SetPwmOutAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.IsPwmOut = !oscilloscope.IsPwmOut;
        oscilloscope.KnobValue = 0;
        SetPwmState(oscilloscope.IsPwmOut);
        return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetPwmOut;
		return;
	}
}
// …Ë÷√pwm∆µ¬ (…¡À∏)
void SetPwmFreqAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.PwmSetFreqValue -= oscilloscope.KnobValue*10;
        oscilloscope.KnobValue = 0;
        Set_Output_Freq(oscilloscope.PwmSetFreqValue);
        return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetPwmFreq;
		return;
	}
}
// …Ë÷√’ºø’±»£®…¡À∏£©
void SetPwmDutyCycleAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.pwmDutyCycle += oscilloscope.KnobValue*10;
        oscilloscope.KnobValue = 0;
        Set_Output_PWMComparex(oscilloscope.pwmDutyCycle);
        return;
    }

	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetPwmDutyCycle;
		return;
	}
}
// …Ë÷√DAC ‰≥ˆ(…¡À∏)
void SetDacOutAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.IsDACOut = !oscilloscope.IsDACOut;
        oscilloscope.KnobValue = 0;
        SetDacState(oscilloscope.IsDACOut);
        return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDacOut;
		return;
	}
}
// …Ë÷√DAC’ºø’±»…¡À∏
void SetDacDutyCycleAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.DacDutyCycle += oscilloscope.KnobValue*10;
        oscilloscope.KnobValue = 0;
        SetDacComparex(oscilloscope.DacDutyCycle);
        return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDacDutyCycle;
		return;
	}
}
// …Ë÷√Ωª÷±¡˜ÒÓ∫œ…¡À∏
void SetDcAcAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.KnobValue = 0;
        SetSignalAcOrDc(!oscilloscope.IsDACDC);
        return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDcAc;
		return;
	}
}
// …Ë÷√À•ºı…¡À∏
void SetDecayAckFc(void){
    if(oscilloscope.KnobValue != 0){
        oscilloscope.KnobValue = 0;
        SetSignalDecay(!oscilloscope.IsDecay);
        return;
    }
	if(F_KeyState(0)){
		oscilloscope.ThisMenu = SetDcAc;
		return;
	}
}

// –ﬁ∏ƒPWM ±ø™πÿ◊¥Ã¨ ±£¨∫Û√Ê¡Ω∏ˆµƒÀ¢–¬
void SetPwmAfterRefresh(bool ResetColor){
    char showData[10]= "";
    // µ⁄∂˛∏ˆ ‰≥ˆ
    DisplayFreq(BLACK,YELLOW);
	// ’ºø’±»
	sprintf(showData,"%3.1f%%  ",((oscilloscope.pwmDutyCycle)/(oscilloscope.timerPeriod+0.0f))*100);
	TFT_ShowString(110,106,(uint8_t *)showData,BLACK,YELLOW,16,0);  
	memset(showData,0,10);
    if(ResetColor){
        TFT_ShowString(110,0,(uint8_t *)("  PWM "),RED,YELLOW,16,0); 
    }else{
        TFT_ShowString(110,0,(uint8_t *)("  PWM "),BLACK,YELLOW,16,0); //ª÷∏¥‘≠¿¥µƒ—’…´
    } 
}

// –ﬁ∏ƒPWM ±∆µ¬ £¨÷–º‰¡Ω∏ˆµƒÀ¢–¬
void SetPwmMiddleRefresh(void){
    char showData[10]= "";
    TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsPwmOut == 1?"¥Úø™":"πÿ±’"),BLACK,YELLOW,16,0);
	// ’ºø’±»
	sprintf(showData,"%3.1f%%  ",((oscilloscope.pwmDutyCycle)/(oscilloscope.timerPeriod+0.0f))*100);
	TFT_ShowString(110,106,(uint8_t *)showData,BLACK,YELLOW,16,0);  
	memset(showData,0,10);      
    TFT_ShowString(110,0,(uint8_t *)("  PWM "),BLACK,YELLOW,16,0); //ª÷∏¥‘≠¿¥µƒ—’…´
}

// –ﬁ∏ƒPWM’ºø’±»£¨«∞√Ê¡Ω∏ˆÀ¢–¬
void SetPwmBeforeRefresh(void){
    char showData[10]= "";
    TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsPwmOut == 1?"¥Úø™":"πÿ±’"),BLACK,YELLOW,16,0);
    DisplayFreq(BLACK,YELLOW);
    TFT_ShowString(110,0,(uint8_t *)("  PWM "),BLACK,YELLOW,16,0); //ª÷∏¥‘≠¿¥µƒ—’…´
}


// –ﬁ∏ƒDAC◊¥Ã¨£®À¢–¬∫Û√Ê¡Ω◊È£©
void SetDacAfterRefresh(bool ResetColor){
    char showData[10]= "";
	//  ‰≥ˆµÁ—π
	sprintf(showData,"%1.2fV ",oscilloscope.DacVoltage);
	TFT_ShowString(110,72,(uint8_t *)showData,BLACK,YELLOW,16,0);  
	// ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
	TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);
    if(ResetColor){
        TFT_ShowString(110,0,(uint8_t *)("  DAC "),RED,YELLOW,16,0); 
    }else{
        TFT_ShowString(110,0,(uint8_t *)("  DAC "),BLACK,YELLOW,16,0); //ª÷∏¥‘≠¿¥µƒ—’…´
    } 
}
// –ﬁ∏ƒDAC’ºø’±»À¢–¬∫Û√Ê¡Ω◊È
void SetDacBeforeRefresh(void){
    TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACOut == 1?"¥Úø™":"πÿ±’"),BLACK,YELLOW,16,0);  
    TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);// ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
}





// œ‘ æ∆µ¬ µƒ∫Ø ˝∑‚◊∞
void DisplayFreq(uint16_t fc,uint16_t bc){
    char showData[10]= "";
    if(oscilloscope.PwmOutFreq>=1000){
        sprintf(showData,"%1.2fK ",oscilloscope.PwmOutFreq/1000.0f);
        TFT_ShowString(110,72,(uint8_t *)showData,fc,bc,16,0);  
        memset(showData,0,10); 
    }else{
        sprintf(showData," %3dHz",oscilloscope.PwmOutFreq);
        TFT_ShowString(110,72,(uint8_t *)showData,fc,bc,16,0);  
        memset(showData,0,10);
    }
}


/*
*   ∫Ø ˝ƒ⁄»›£∫  œ‘ æ◊÷∑˚¥Æ
*   ∫Ø ˝≤Œ ˝£∫  uint16_t vpp--∑Â∑Â÷µ
*               uint16_t freq-∆µ¬ 
*               float DoBias--÷±¡˜∆´÷¥–≈∫≈
*   ∑µªÿ÷µ£∫    Œﬁ
*/
void TFT_ShowUI(void){
    static uint16_t counter;
    counter++;
	//  ‰»ÎµÁ—π
    char showData[10]= "";
    sprintf(showData,"%1.2fV ",oscilloscope.vpp);
    TFT_ShowString(5,106,(uint8_t *)showData,BLACK,GREEN,16,0);  
    memset(showData,0,10);
    
	//  ‰»Î∆µ¬ 
    if(oscilloscope.gatherFreq>=1000){
        sprintf(showData,"%1.1fKHz",oscilloscope.gatherFreq/1000.0f);
        TFT_ShowString(55,106,(uint8_t *)showData,BLACK,GREEN,16,0);  
        memset(showData,0,10);
    }else{
        sprintf(showData,"%3.0fHz ",oscilloscope.gatherFreq);
        TFT_ShowString(55,106,(uint8_t *)showData,BLACK,GREEN,16,0);  
        memset(showData,0,10);  
    }
	
	switch (oscilloscope.ThisMenu){
	case PWM:
        // µ⁄“ª∏ˆ◊¥Ã¨
        TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsPwmOut == 1?"¥Úø™":"πÿ±’"),BLACK,YELLOW,16,0);   
        SetPwmAfterRefresh(true);
		break;
    case SetPwmOut: //…Ë÷√PWM ‰≥ˆ◊¥Ã¨(—°‘ÒΩ◊∂Œ)
        TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsPwmOut == 1?"¥Úø™":"πÿ±’"),RED,YELLOW,16,0);   
        SetPwmAfterRefresh(false);
        break;
    case SetPwmOutAck:  //…Ë÷√PWM ‰≥ˆ◊¥Ã¨(…¡À∏)
        if(counter == 2){
            TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsPwmOut == 1?"¥Úø™":"πÿ±’"),RED,BLUE,16,0);   
        }
        if(counter >= 4){
            counter = 0;
            TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsPwmOut == 1?"¥Úø™":"πÿ±’"),RED,YELLOW,16,0);  
        }
        SetPwmAfterRefresh(false);
        break;
   	case SetPwmFreq://…Ë÷√Pwm∆µ¬ 
        DisplayFreq(RED,YELLOW);
        SetPwmMiddleRefresh();
        break;
    case SetPwmFreqAck: //…Ë÷√Pwm∆µ¬ (…¡À∏)
        if(counter == 2){DisplayFreq(RED,BLUE);}
        if(counter >= 4){
            counter = 0;
            DisplayFreq(RED,YELLOW);
        }
        SetPwmMiddleRefresh();
        break;

   	case SetPwmDutyCycle://…Ë÷√PWM’ºø’±»
        sprintf(showData,"%3.1f%%  ",((oscilloscope.pwmDutyCycle)/(oscilloscope.timerPeriod+0.0f))*100);
        TFT_ShowString(110,106,(uint8_t *)showData,RED,YELLOW,16,0);    
        SetPwmBeforeRefresh();
        break;
    case SetPwmDutyCycleAck:  //…Ë÷√’ºø’±»£®…¡À∏£©
        sprintf(showData,"%3.1f%%  ",((oscilloscope.pwmDutyCycle)/(oscilloscope.timerPeriod+0.0f))*100);
        if(counter == 2){
            TFT_ShowString(110,106,(uint8_t *)showData,RED,BLUE,16,0);  
        }
        if(counter >= 4){
            counter = 0;
            TFT_ShowString(110,106,(uint8_t *)showData,RED,YELLOW,16,0);  
        }  
        SetPwmBeforeRefresh();
        break;

    // ø™ º¥¶¿ÌDAC
	case DAC:
		// µ⁄“ª∏ˆ◊¥Ã¨
		TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACOut == 1?"¥Úø™":"πÿ±’"),BLACK,YELLOW,16,0);   
        SetDacAfterRefresh(true);
		break;
    case SetDacOut:
		TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACOut == 1?"¥Úø™":"πÿ±’"),RED,YELLOW,16,0);   
        SetDacAfterRefresh(false);
        break;
    case SetDacOutAck:
        if(counter == 2){
            TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACOut == 1?"¥Úø™":"πÿ±’"),RED,YELLOW,16,0);  
        }
        if(counter >= 4){
            counter = 0;
            TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACOut == 1?"¥Úø™":"πÿ±’"),BLACK,YELLOW,16,0);  
        }
        SetDacAfterRefresh(false);
        break;
    case SetDacDutyCycle:
        sprintf(showData,"%1.2fV ",oscilloscope.DacVoltage);
        TFT_ShowString(110,72,(uint8_t *)showData,RED,YELLOW,16,0); 
        SetDacBeforeRefresh();
        break;
    case SetDacDutyCycleAck:
        sprintf(showData,"%1.2fV ",oscilloscope.DacVoltage);
        if(counter == 2){
            TFT_ShowString(110,72,(uint8_t *)showData,RED,YELLOW,16,0); 
        }
        if(counter >= 4){
            counter = 0;
            TFT_ShowString(110,72,(uint8_t *)showData,BLACK,YELLOW,16,0); 
        }
        SetDacBeforeRefresh();
        break;
	case SetInput:
        TFT_ShowString(110,0,(uint8_t *)("  SET "),RED,YELLOW,16,0);  
		TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACDC == 1?"÷±¡˜":"Ωª¡˜"),BLACK,YELLOW,16,0);// µ⁄“ª∏ˆ◊¥Ã¨
		TFT_ShowString(110,72,(uint8_t *)(oscilloscope.IsDecay == 0 ? " 1/50":"  No "),BLACK,YELLOW,16,0); // ”–ŒﬁÀ•ºı
		TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);  // ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
		break;
	case SetDcAc:
        TFT_ShowString(110,0,(uint8_t *)("  SET "),BLACK,YELLOW,16,0);  
        TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACDC == 1?"÷±¡˜":"Ωª¡˜"),RED,YELLOW,16,0);// µ⁄“ª∏ˆ◊¥Ã¨
		TFT_ShowString(110,72,(uint8_t *)(oscilloscope.IsDecay == 0 ? " 1/50":"  No "),BLACK,YELLOW,16,0); // ”–ŒﬁÀ•ºı
		TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);  // ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
    break;
    case SetDcAcAck:
        if(counter == 2){
            TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACDC == 1?"÷±¡˜":"Ωª¡˜"),RED,YELLOW,16,0);
        }
        if(counter >= 4){
            counter = 0;
            TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACDC == 1?"÷±¡˜":"Ωª¡˜"),BLACK,YELLOW,16,0);
        }
        TFT_ShowString(110,0,(uint8_t *)("  SET "),BLACK,YELLOW,16,0);  
		TFT_ShowString(110,72,(uint8_t *)(oscilloscope.IsDecay == 0 ? " 1/50":"  No "),BLACK,YELLOW,16,0); // ”–ŒﬁÀ•ºı
		TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);  // ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
    break;
    case SetDecay:
        TFT_ShowString(110,0,(uint8_t *)("  SET "),BLACK,YELLOW,16,0);  
        TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACDC == 1?"÷±¡˜":"Ωª¡˜"),BLACK,YELLOW,16,0);// µ⁄“ª∏ˆ◊¥Ã¨
		TFT_ShowString(110,72,(uint8_t *)(oscilloscope.IsDecay == 0 ? " 1/50":"  No "),RED,YELLOW,16,0); // ”–ŒﬁÀ•ºı
		TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);  // ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
    break;
    case SetDecayAck:
        if(counter == 2){
            TFT_ShowString(110,72,(uint8_t *)(oscilloscope.IsDecay == 0 ? " 1/50":"  No "),RED,YELLOW,16,0); // ”–ŒﬁÀ•ºı
        }
        if(counter >= 4){
            counter = 0;
            TFT_ShowString(110,72,(uint8_t *)(oscilloscope.IsDecay == 0 ? " 1/50":"  No "),BLACK,YELLOW,16,0); // ”–ŒﬁÀ•ºı
        }
        TFT_ShowString(110,0,(uint8_t *)("  SET "),BLACK,YELLOW,16,0);  
        TFT_ShowChinese(118,36,(uint8_t *)(oscilloscope.IsDACDC == 1?"÷±¡˜":"Ωª¡˜"),BLACK,YELLOW,16,0);// µ⁄“ª∏ˆ◊¥Ã¨
		TFT_ShowString(110,106,(uint8_t *)"      ",YELLOW,YELLOW,16,0);  // ’ºø’±»(’‚¿ÔŒﬁƒ⁄»›)
    break;

	default:
		break;
	}
    memset(showData,0,10);  
}